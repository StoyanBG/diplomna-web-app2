// Predefined bus schedule in HH:MM format
const busSchedule = ["05:30", "05:44", "05:58", "06:12", "06:24", "06:40",'06:52', '07:06', '07:20', '07:34', '07:48', '08:02', 
    '08:16', '08:30', '08:44', '08:58', '09:12', '09:26', '09:40', '09:54', '10:08', '10:22', '10:36', '10:50', '11:04', '11:18', 
    '11:32', '11:46', '12:00', '12:14', '12:28', '12:42', '12:56', '13:10', '13:24', '13:38', '13:52', '14:06', '14:20', '14:34', 
    '14:48', '15:02', '15:16', '15:30', '15:44', '15:58', '16:12', '16:26', '16:40', '16:54', '17:08', '17:30',"18:00","18:26",
    "18:40","18:54","18:20","19:50,","20:46"];

    // Function to find the next bus
    function findNextBus() {
        const userTimeInput = document.getElementById('userTime').value;

        if (!userTimeInput) {
            document.getElementById('result').textContent = 'Please enter a valid time.';
            return;
        }

        const nextBus = busSchedule.find(busTime => busTime >= userTimeInput);

        if (nextBus) {
            document.getElementById('result').textContent = `The next bus is at ${nextBus}.`;
        } else {
            document.getElementById('result').textContent = 'No more buses today.';
        }
    }
    var map = L.map('map').setView([42.1354, 24.7453], 13);

    // Add the OpenStreetMap tile layer
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
    }).addTo(map);

    // Define the bus route (example coordinates)
    var busRoute = [
  [42.1342825651061, 24.75537530255056, 0],
  [42.13258104590624, 24.75773183629652, 0],
  [42.13264909794466, 24.75816629782603, 0],
  [42.13294887520092, 24.7584809995634, 0],
  [42.1335341294, 24.75774137371288, 0],
  [42.13346421910179, 24.75704739913927, 0],
  [42.13286141384597, 24.75602937964851, 0],
  [42.13188734867054, 24.75517585807889, 0],
  [42.13088717664681, 24.75510837585895, 0],
  [42.13066959932482, 24.75538042590079, 0],
  [42.13070922930302, 24.75573714049309, 0],
  [42.13085480121552, 24.75595849012016, 0],
  [42.13152857248068, 24.75573609717923, 0],
  [42.13162226420805, 24.75536003241169, 0],
  [42.13150439516923, 24.75478732931179, 0],
  [42.1299726241508, 24.75464680513991, 0],
  [42.1299441637329, 24.75345524340483, 0],
  [42.13000910845241, 24.75160973473568, 0],
  [42.13027071263685, 24.74556051655691, 0],
  [42.13029848519432, 24.74413588199629, 0],
  [42.12655605778579, 24.74209460205719, 0],
  [42.12591016716334, 24.75469107491731, 0],
  [42.12273337464584, 24.75514705790502, 0],
  [42.12231713867877, 24.75072493334982, 0],
  [42.12296814854669, 24.74594474335455, 0],
  [42.12395547489204, 24.74083782935132, 0],
  [42.1264896794154, 24.7333975932081, 0],
  [42.12907790938794, 24.7225143064721, 0],
  [42.12552549500275, 24.71997213410483, 0],
  [42.12538042686005, 24.72025970668863, 0],
  [42.12522890635751, 24.72032517487023, 0],
  [42.12521241957734, 24.72080210994588, 0],
  [42.12529865643113, 24.72088344524463, 0],
  [42.12558850203287, 24.72018135040493, 0],
  [42.12909424365512, 24.72297044979945, 0],
  [42.12729762708089, 24.73043294377441, 0],
  [42.12605507499387, 24.73518784102895, 0],
  [42.12411440074439, 24.74084193206691, 0],
  [42.12266601692922, 24.74931294828277, 0],
  [42.12284591230576, 24.7550322885455, 0],
  [42.12580278304176, 24.75450543225123, 0],
  [42.12635879564544, 24.74169337912727, 0],
  [42.130456557588, 24.74401076235904, 0],
  [42.13040853661958, 24.74565469376648, 0],
  [42.13002505243286, 24.75499217584868, 0],
  [42.13114983777616, 24.75491680640961, 0],
  [42.13280177495368, 24.75567728358336, 0],
  [42.1334556818741, 24.75611332038117, 0],
  [42.13440642294655, 24.75478571432366, 0],
  [42.13638274618362, 24.75243341686778, 0],
  [42.13654023874736, 24.75335706306251, 0],
  [42.13631389991419, 24.76248736205554, 0],
  [42.14226917272937, 24.76269081420337, 0],
  [42.14701895300675, 24.76283181542763, 0],
  [42.14907825557199, 24.77470093732319, 0],
  [42.14922485855676, 24.77699308285877, 0],
  [42.14866430749752, 24.78610697220083, 0],
  [42.1528273261809, 24.78675837974135, 0],
  [42.15268997727315, 24.78929452313619, 0],
  [42.15516557201009, 24.78975943409302, 0],
  [42.15650265488679, 24.79035893864976, 0],
  [42.15732516484469, 24.78825693908449, 0],
  [42.15896129083862, 24.78909107142129, 0],
  [42.15941952502062, 24.78594276022886, 0],
  [42.15970475325463, 24.78123851059591, 0],
  [42.15972086030723, 24.78123700106309, 0],
  [42.15959370491849, 24.78115799883407, 0],
  [42.15944902295661, 24.78131535334062, 0],
  [42.1595685284844, 24.78161118249475, 0],
  [42.15969855178257, 24.78190838630039, 0],
  [42.15958201268192, 24.78584149873985, 0],
  [42.15905440326752, 24.78928586900048, 0],
  [42.15738724280026, 24.78850801663967, 0],
  [42.15661962024901, 24.79070221277744, 0],
  [42.15489694097127, 24.78986945607211, 0],
  [42.15305318491433, 24.78949291930342, 0],
  [42.15307216440241, 24.78949243925756, 0],
  [42.15251057985019, 24.78944879021002, 0],
  [42.15270664868011, 24.78692854054954, 0],
  [42.1484898413686, 24.78632764232966, 0],
  [42.14895755409579, 24.77758012933965, 0],
  [42.14856699975469, 24.77287010703354, 0],
  [42.14780053871677, 24.76843984919791, 0],
  [42.14680594246083, 24.76299192637139, 0],
  [42.1443326657327, 24.76300505074552, 0],
  [42.13642029163613, 24.76282998820745, 0],
  [42.13626107166399, 24.76271429805294, 0],
  [42.13617531950403, 24.76232960840484, 0],
  [42.13629280759834, 24.75286334748431, 0],
  [42.13598094991651, 24.75308477896432, 0],
  [42.13428606518855, 24.75539146154247, 0]
  

  ];


    // Create a polyline for the bus route and add it to the map
    L.polyline(busRoute, {color: 'red'}).addTo(map);
    document.getElementById('main-page-button').addEventListener('click', function(event) {
          event.preventDefault(); // Prevent the default anchor click behavior

          // Check authentication status
          fetch('/check-auth')
              .then(response => response.json())
              .then(data => {
                  if (data.isAuthenticated) {
                      // Redirect to success.html if authenticated
                      window.location.href = '/cl.html';
                  } else {
                      // Redirect to login.html if not authenticated
                      window.location.href = '/login.html';
                  }
              })
              .catch(error => {
                  console.error('Error checking authentication:', error);
                  // Handle error, maybe redirect to login or show a message
                  window.location.href = '/login.html';
              });
      });